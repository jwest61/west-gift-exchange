<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Christmas Gift Exchange ğŸ</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      display: flex;
      min-height: 100vh;
      margin: 0;
      background: #f5f5f5;
    }
    .left {
      width: 30%;
      background: #fff;
      padding: 20px;
      border-right: 2px solid #ddd;
    }
    .left h2 {
      margin-bottom: 10px;
      color: #b30000;
    }
    .left table {
      width: 100%;
      border-collapse: collapse;
    }
    .left th, .left td {
      padding: 8px;
      border-bottom: 1px solid #eee;
    }
    .main {
      flex: 1;
      padding: 20px;
    }
    .tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      margin-bottom: 20px;
    }
    .tab {
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 20px;
      padding: 10px 20px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .tab.active {
      background: #b30000;
      color: #fff;
      font-weight: bold;
    }
    .gift-list {
      margin-top: 20px;
    }
    .gift-item {
      background: #fff;
      padding: 10px;
      margin-bottom: 8px;
      border-radius: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid #ddd;
    }
    .gift-item button {
      background: #ff5c5c;
      border: none;
      color: white;
      border-radius: 8px;
      padding: 4px 10px;
      cursor: pointer;
    }
    .add-form {
      background: #fff;
      padding: 10px;
      border-radius: 10px;
      margin-top: 20px;
    }
    input, select {
      margin: 5px;
      padding: 6px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button.add {
      background: #b30000;
      color: #fff;
      border: none;
      padding: 6px 12px;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="left">
    <h2>ğŸ… Gift Pairings</h2>
    <table>
      <tr><td>Jon â†’ Katie</td></tr>
      <tr><td>Dave â†’ Jason</td></tr>
      <tr><td>Karen â†’ Chelsea</td></tr>
      <tr><td>Jen â†’ Stef</td></tr>
      <tr><td>Dan â†’ Jon</td></tr>
      <tr><td>Jason â†’ Dave</td></tr>
      <tr><td>Stef â†’ Geoff</td></tr>
      <tr><td>Katie â†’ Dan</td></tr>
      <tr><td>Chelsea â†’ Jen</td></tr>
      <tr><td>Geoff â†’ Karen</td></tr>
      <tr><td>Eddie â†’ Gwen</td></tr>
      <tr><td>Gwen â†’ Evie</td></tr>
      <tr><td>Evie â†’ Claire</td></tr>
      <tr><td>Claire â†’ Eddie</td></tr>
      <tr><td>Main â†’ Theo</td></tr>
      <tr><td>Theo â†’ Elora</td></tr>
      <tr><td>Elora â†’ Main</td></tr>
      <tr><td>Eden â†’ Nora</td></tr>
      <tr><td>Nora â†’ Eden</td></tr>
    </table>
  </div>

  <div class="main">
    <div class="tabs" id="tabs"></div>
    <div id="content"></div>
  </div>

  <script>
    const SHEET_URL = "https://script.google.com/macros/s/AKfycbw7ouiHoNqOHdM6IJsQrynNkyjkHg-2owdKmpyCAcoyyfd6Aspr3k9w6AiBZPsCslN38w/exec";
    const givers = [
      "Jon","Dave","Karen","Jen","Dan","Jason","Stef","Katie","Chelsea","Geoff",
      "Eddie","Gwen","Evie","Claire","Main","Theo","Elora","Eden","Nora"
    ];

    const tabsDiv = document.getElementById("tabs");
    const contentDiv = document.getElementById("content");
    let currentGiver = null;
    let gifts = [];

    async function loadGifts() {
      const res = await fetch(SHEET_URL);
      gifts = await res.json();
      showGifts(currentGiver);
    }

    async function addGift(giver, name, priority, price) {
      await fetch(SHEET_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ action: "add", Giver: giver, "Gift Name": name, Priority: priority, Price: price })
      });
      await loadGifts();
    }

    async function deleteGift(giver, name) {
      await fetch(SHEET_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ action: "delete", Giver: giver, "Gift Name": name })
      });
      await loadGifts();
    }

    function showGifts(giver) {
      currentGiver = giver;
      tabsDiv.querySelectorAll(".tab").forEach(t => t.classList.toggle("active", t.textContent === giver));
      const giverGifts = gifts.filter(g => g.Giver === giver);

      let html = `<h2>${giver}'s Gift Ideas</h2><div class="gift-list">`;
      if (giverGifts.length === 0) html += `<p>No gifts yet â€” add one below!</p>`;
      giverGifts.forEach(g => {
        html += `
          <div class="gift-item">
            <span>ğŸ ${g["Gift Name"]} â€” ${g.Priority} â€” $${g.Price}</span>
            <button onclick="deleteGift('${giver}','${g["Gift Name"]}')">Remove</button>
          </div>`;
      });
      html += `</div>`;

      html += `
        <div class="add-form">
          <h3>Add a new gift</h3>
          <input id="giftName" placeholder="Gift name" />
          <select id="giftPriority">
            <option>High</option>
            <option>Medium</option>
            <option>Low</option>
          </select>
          <input id="giftPrice" placeholder="Price" type="number" />
          <button class="add" onclick="handleAdd()">Add Gift</button>
        </div>
      `;
      contentDiv.innerHTML = html;
    }

    async function handleAdd() {
      const name = document.getElementById("giftName").value.trim();
      const priority = document.getElementById("giftPriority").value;
      const price = document.getElementById("giftPrice").value.trim();
      if (!name || !price) return alert("Please fill in all fields!");
      await addGift(currentGiver, name, priority, price);
      document.getElementById("giftName").value = "";
      document.getElementById("giftPrice").value = "";
    }

    function initTabs() {
      givers.forEach(g => {
        const tab = document.createElement("div");
        tab.className = "tab";
        tab.textContent = g;
        tab.onclick = () => showGifts(g);
        tabsDiv.appendChild(tab);
      });
      showGifts(givers[0]);
      loadGifts();
    }

    initTabs();
  </script>
</body>
</html>


